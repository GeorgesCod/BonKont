@tailwind base;
@tailwind components;
@tailwind utilities;
 
@layer base {
  :root {
    --background: 0 0% 100%;
    --foreground: 240 10% 3.9%;
    --card: 0 0% 100%;
    --card-foreground: 240 10% 3.9%;
    --popover: 0 0% 100%;
    --popover-foreground: 240 10% 3.9%;
    --primary: 263.4 70% 50.4%;
    --primary-foreground: 210 40% 98%;
    --secondary: 217 91% 60%;
    --secondary-foreground: 210 40% 98%;
    --muted: 240 4.8% 95.9%;
    --muted-foreground: 240 3.8% 46.1%;
    --accent: 263.4 70% 50.4%;
    --accent-foreground: 240 5.9% 10%;
    --destructive: 0 84.2% 60.2%;
    --destructive-foreground: 0 0% 98%;
    --border: 240 5.9% 90%;
    --input: 240 5.9% 90%;
    --ring: 263.4 70% 50.4%;
    --radius: 0.75rem;
  }

  .dark {
    --background: 240 10% 3.9%;
    --foreground: 0 0% 98%;
    --card: 240 10% 3.9%;
    --card-foreground: 0 0% 98%;
    --popover: 240 10% 3.9%;
    --popover-foreground: 0 0% 98%;
    --primary: 263.4 70% 50.4%;
    --primary-foreground: 210 40% 98%;
    --secondary: 217 91% 60%;
    --secondary-foreground: 210 40% 98%;
    --muted: 240 3.7% 15.9%;
    --muted-foreground: 240 5% 64.9%;
    --accent: 263.4 70% 50.4%;
    --accent-foreground: 0 0% 98%;
    --destructive: 0 84% 60%;
    --destructive-foreground: 0 0% 98%;
    --border: 240 3.7% 15.9%;
    --input: 240 3.7% 15.9%;
    --ring: 263.4 70% 50.4%;
  }

  * {
    @apply border-border;
  }
  
  /* S'assurer que #root permet le scroll */
  #root {
    width: 100%;
    min-height: 100%;
    height: auto;
    overflow: visible;
    position: relative;
  }
  
  /* Empêcher le scroll horizontal global */
  html {
    overflow-x: hidden;
    overflow-y: auto; /* Permet le scroll vertical */
    width: 100%;
    max-width: 100vw;
    height: auto; /* Permet au html de grandir avec le contenu */
    min-height: 100%;
  }

  html, body {
    position: relative;
    overflow-x: hidden;
    overflow-y: auto !important; /* Permet le scroll vertical sur html et body - FORCE */
    height: auto;
    min-height: 100%;
  }
  
  body {
    @apply bg-background text-foreground transition-colors duration-300;
    background: linear-gradient(
      to bottom,
      transparent,
      hsl(var(--background))
    ),
    linear-gradient(
      to bottom,
      hsl(var(--card) / 0.9),
      hsl(var(--background) / 0.9)
    ),
    radial-gradient(
      circle at center,
      hsl(var(--primary) / 0.1) 0%,
      hsl(var(--background) / 0.9) 100%
    );
    background-attachment: fixed;
    margin: 0;
    padding: 0;
    width: 100%;
    min-height: 100vh;
    min-height: -webkit-fill-available; /* Pour mobile */
    scroll-behavior: smooth;
    -webkit-overflow-scrolling: touch;
    overscroll-behavior-y: contain; /* Évite le pull-to-refresh accidentel */
    overflow-x: hidden !important; /* Empêche le scroll horizontal */
    overflow-y: auto !important; /* Permet le scroll vertical - FORCE */
    position: relative;
    touch-action: pan-y; /* Permet le scroll vertical, bloque le zoom */
  }

  /* Styles pour le défilement fluide */
  ::-webkit-scrollbar {
    width: 8px;
    height: 8px;
  }

  ::-webkit-scrollbar-track {
    background: hsl(var(--background));
  }

  ::-webkit-scrollbar-thumb {
    background: hsl(var(--primary) / 0.3);
    border-radius: var(--radius);
  }

  ::-webkit-scrollbar-thumb:hover {
    background: hsl(var(--primary) / 0.5);
  }

  /* Styles pour le responsive design */
  @media (max-width: 768px) {
    .container {
      @apply px-3 sm:px-4;
      width: 100%;
      max-width: 100%;
      margin-left: auto;
      margin-right: auto;
    }

    /* S'assurer que tous les éléments ne débordent pas */
    * {
      box-sizing: border-box;
    }

    /* Empêcher le débordement horizontal */
    img, video, iframe, embed, object {
      max-width: 100%;
      height: auto;
    }

    /* Tables responsive */
    table {
      width: 100%;
      table-layout: auto;
    }

    .glass-morphism {
      @apply backdrop-blur-md;
    }

    .neon-border {
      @apply border-opacity-30;
    }

    .button-glow::before {
      @apply opacity-50;
    }

    /* Optimisations pour mobile */
    body {
      font-size: 16px; /* Évite le zoom automatique sur iOS */
      -webkit-text-size-adjust: 100%;
    }

    /* Zones tactiles minimales et interactions */
    button, a, input[type="button"], input[type="submit"], [role="button"] {
      min-height: 44px;
      min-width: 44px;
      touch-action: manipulation; /* Évite le double-tap zoom */
      -webkit-tap-highlight-color: rgba(0, 0, 0, 0.1); /* Feedback visuel au tap */
      cursor: pointer;
      user-select: none; /* Évite la sélection de texte accidentelle */
      -webkit-user-select: none;
      -moz-user-select: none;
      -ms-user-select: none;
    }

    /* S'assurer que les boutons sont cliquables */
    button:not(:disabled),
    a:not(:disabled),
    [role="button"]:not(:disabled) {
      pointer-events: auto !important;
    }

    /* Empêcher les éléments de bloquer les interactions */
    * {
      -webkit-touch-callout: none; /* Désactive le menu contextuel iOS */
    }

    /* Safe area pour iPhone avec encoche - appliqué uniquement aux éléments spécifiques */
    @supports (padding: max(0px)) {
      /* Ne pas appliquer aux body pour éviter les décalages */
      /* Les safe areas seront appliquées via les classes utilitaires */
      
      .safe-top {
        padding-top: max(0.75rem, env(safe-area-inset-top));
      }

      .safe-bottom {
        padding-bottom: max(1rem, env(safe-area-inset-bottom));
      }

      .safe-left {
        padding-left: max(0.75rem, env(safe-area-inset-left));
      }

      .safe-right {
        padding-right: max(0.75rem, env(safe-area-inset-right));
      }

      /* Header avec safe area uniquement en haut */
      header.safe-top {
        padding-top: max(0.75rem, env(safe-area-inset-top));
      }
    }
  }

  /* Styles pour les interactions tactiles */
  @media (hover: none) {
    .hover-glow:hover {
      transform: none;
      text-shadow: none;
    }

    .neon-border:hover {
      border-color: hsl(var(--primary) / 0.2);
      box-shadow: none;
    }

    .button-glow:active {
      transform: translateY(1px);
    }

    /* Feedback tactile amélioré */
    button:active,
    a:active,
    [role="button"]:active {
      opacity: 0.7;
      transform: scale(0.98);
      transition: all 0.1s ease;
    }

    /* S'assurer que les éléments sont interactifs */
    button:not(:disabled),
    a:not(:disabled) {
      pointer-events: auto;
      touch-action: manipulation;
    }
  }

  /* Amélioration du scroll sur mobile */
  @media (max-width: 768px) {
    main {
      overflow: visible !important; /* Le scroll se fait sur le body, pas sur main */
      -webkit-overflow-scrolling: touch !important;
      touch-action: pan-y !important;
      position: relative;
      z-index: 1;
    }

    /* S'assurer que le contenu peut scroller */
    .space-y-6,
    .space-y-4 {
      position: relative;
    }

    /* Empêcher les éléments de bloquer le scroll */
    header {
      position: sticky;
      top: 0;
      z-index: 50;
      background: hsl(var(--background) / 0.95);
      backdrop-filter: blur(10px);
      -webkit-backdrop-filter: blur(10px);
    }

    /* S'assurer que les cartes et contenus sont interactifs */
    [role="main"],
    .container {
      position: relative;
      z-index: 1;
    }

    /* Améliorer les interactions avec les cartes */
    .neon-border,
    [class*="card"],
    [class*="Card"] {
      touch-action: manipulation;
      -webkit-tap-highlight-color: transparent;
    }

    /* S'assurer que les liens et boutons dans les cartes fonctionnent */
    .neon-border button,
    .neon-border a,
    [class*="card"] button,
    [class*="card"] a {
      position: relative;
      z-index: 2;
      pointer-events: auto !important;
    }

    /* Empêcher les overlays de bloquer les interactions */
    [class*="overlay"]:not([class*="dialog"]):not([class*="modal"]) {
      pointer-events: none;
    }

    [class*="overlay"]:not([class*="dialog"]):not([class*="modal"]) > * {
      pointer-events: auto;
    }
  }

  /* Styles existants... */
  .neon-glow {
    text-shadow: 0 0 10px hsl(var(--primary) / 0.6),
                 0 0 20px hsl(var(--primary) / 0.4),
                 0 0 30px hsl(var(--primary) / 0.2);
  }

  .neon-box {
    box-shadow: 0 0 10px hsl(var(--primary) / 0.4),
                inset 0 0 5px hsl(var(--primary) / 0.3);
  }

  .neon-border {
    border: 1px solid hsl(var(--primary) / 0.2);
    background: linear-gradient(
      135deg,
      hsl(var(--card) / 0.95),
      hsl(var(--card) / 0.7)
    );
    box-shadow: 
      0 0 20px hsl(var(--primary) / 0.1),
      inset 0 0 30px hsl(var(--primary) / 0.05);
    transition: all 0.3s ease;
    backdrop-filter: blur(12px);
  }

  /* Styles pour le défilement personnalisé */
  .scrollbar-custom {
    scrollbar-width: thin;
    scrollbar-color: hsl(var(--primary) / 0.3) transparent;
  }

  .scrollbar-custom::-webkit-scrollbar {
    width: 8px;
    height: 8px;
  }

  .scrollbar-custom::-webkit-scrollbar-track {
    background: transparent;
  }

  .scrollbar-custom::-webkit-scrollbar-thumb {
    background-color: hsl(var(--primary) / 0.3);
    border-radius: var(--radius);
    border: 2px solid transparent;
    background-clip: padding-box;
  }

  .scrollbar-custom::-webkit-scrollbar-thumb:hover {
    background-color: hsl(var(--primary) / 0.5);
  }

  /* Support tactile */
  @supports (-webkit-overflow-scrolling: touch) {
    .scrollbar-custom {
      -webkit-overflow-scrolling: touch;
      overflow-y: auto;
    }
  }

  /* Optimisations pour le défilement fluide */
  * {
    scroll-behavior: smooth;
  }

  @media (prefers-reduced-motion: reduce) {
    * {
      scroll-behavior: auto;
    }
  }

  /* Améliorations pour mobile immersif */
  @media (max-width: 640px) {
    /* Empêcher le zoom sur focus des inputs */
    input[type="text"],
    input[type="email"],
    input[type="number"],
    input[type="tel"],
    input[type="date"],
    input[type="time"],
    textarea,
    select {
      font-size: 16px !important; /* Évite le zoom automatique sur iOS */
    }

    /* Améliorer les espacements pour mobile */
    .space-y-4 > * + * {
      margin-top: 1rem;
    }

    .space-y-6 > * + * {
      margin-top: 1.5rem;
    }

    /* Cards plus compactes sur mobile */
    .neon-border {
      padding: 1rem;
    }

    /* Textes plus lisibles */
    p, span, div {
      line-height: 1.6;
    }
  }

  /* Support pour les appareils avec encoche - déjà défini dans la section mobile */

  /* Styles pour le ScrollArea */
  .scrollarea-viewport {
    @apply h-full w-full rounded-[inherit];
  }

  .scrollarea-scrollbar {
    @apply flex touch-none select-none p-0.5 bg-transparent transition-colors duration-150 ease-out;
  }

  .scrollarea-scrollbar[data-orientation="vertical"] {
    @apply h-full w-2.5 border-l border-l-transparent;
  }

  .scrollarea-scrollbar[data-orientation="horizontal"] {
    @apply h-2.5 flex-col border-t border-t-transparent;
  }

  .scrollarea-thumb {
    @apply relative flex-1 rounded-full bg-border hover:bg-primary/50 transition-colors duration-150 ease-out;
  }

  /* Animations pour le code événement */
  @keyframes pulse-slow {
    0%, 100% {
      opacity: 1;
      transform: scale(1);
    }
    50% {
      opacity: 0.8;
      transform: scale(1.02);
    }
  }

  @keyframes spin-slow {
    from {
      transform: rotate(0deg);
    }
    to {
      transform: rotate(360deg);
    }
  }

  @keyframes fade-in-up {
    from {
      opacity: 0;
      transform: translate(-50%, -10px);
    }
    to {
      opacity: 1;
      transform: translate(-50%, 0);
    }
  }

  @keyframes bounce-gentle {
    0%, 100% {
      transform: translate(-50%, 0);
    }
    50% {
      transform: translate(-50%, -5px);
    }
  }

  .animate-pulse-slow {
    animation: pulse-slow 3s ease-in-out infinite;
  }

  .animate-spin-slow {
    animation: spin-slow 3s linear infinite;
  }

  .animate-fade-in-up {
    animation: fade-in-up 0.5s ease-out forwards;
  }

  .animate-bounce-gentle {
    animation: bounce-gentle 2s ease-in-out infinite;
  }

  /* Style pour le badge du code événement */
  .event-code-badge {
    position: relative;
    background: linear-gradient(135deg, hsl(var(--primary) / 0.1), hsl(var(--primary) / 0.05));
    border-color: hsl(var(--primary) / 0.4);
    box-shadow: 0 0 15px hsl(var(--primary) / 0.2),
                0 0 30px hsl(var(--primary) / 0.1),
                inset 0 0 20px hsl(var(--primary) / 0.05);
  }

  .event-code-badge:hover {
    background: linear-gradient(135deg, hsl(var(--primary) / 0.2), hsl(var(--primary) / 0.1));
    border-color: hsl(var(--primary) / 0.6);
    box-shadow: 0 0 20px hsl(var(--primary) / 0.4),
                0 0 40px hsl(var(--primary) / 0.2),
                inset 0 0 30px hsl(var(--primary) / 0.1);
  }

  .event-code-badge::before {
    content: '';
    position: absolute;
    top: -2px;
    left: -2px;
    right: -2px;
    bottom: -2px;
    background: linear-gradient(45deg, 
      hsl(var(--primary) / 0.5),
      hsl(var(--secondary) / 0.5),
      hsl(var(--primary) / 0.5)
    );
    border-radius: inherit;
    z-index: -1;
    opacity: 0;
    transition: opacity 0.3s ease;
    animation: pulse-slow 3s ease-in-out infinite;
  }

  .event-code-badge:hover::before {
    opacity: 0.3;
  }

  /* Styles pour le bouton "Mes Participations" */
  .mes-participations-btn {
    position: relative;
    overflow: visible;
    background: linear-gradient(135deg, hsl(var(--primary) / 0.9), hsl(var(--primary) / 0.7));
    border: 2px solid hsl(var(--primary) / 0.5);
    box-shadow: 0 0 15px hsl(var(--primary) / 0.3),
                0 0 30px hsl(var(--primary) / 0.2),
                inset 0 0 20px hsl(var(--primary) / 0.1);
  }

  .mes-participations-btn:hover {
    background: linear-gradient(135deg, hsl(var(--primary)), hsl(var(--primary) / 0.9));
    border-color: hsl(var(--primary) / 0.8);
    box-shadow: 0 0 20px hsl(var(--primary) / 0.5),
                0 0 40px hsl(var(--primary) / 0.3),
                inset 0 0 30px hsl(var(--primary) / 0.2);
    transform: scale(1.05);
  }

  .mes-participations-btn::before {
    content: '';
    position: absolute;
    top: -2px;
    left: -2px;
    right: -2px;
    bottom: -2px;
    background: linear-gradient(45deg, 
      hsl(var(--primary) / 0.6),
      hsl(var(--secondary) / 0.6),
      hsl(var(--primary) / 0.6)
    );
    border-radius: inherit;
    z-index: -1;
    opacity: 0;
    transition: opacity 0.3s ease;
    animation: pulse-slow 2s ease-in-out infinite;
  }

  .mes-participations-btn:hover::before {
    opacity: 0.4;
  }

  /* Styles pour le bouton "Scanner un ticket CB" - Innovation mise en avant */
  .scanner-ticket-btn {
    position: relative;
    overflow: visible;
    background: linear-gradient(135deg, hsl(var(--primary) / 0.15), hsl(var(--primary) / 0.05));
    border: 2px solid hsl(var(--primary) / 0.5) !important;
    box-shadow: 0 0 20px hsl(var(--primary) / 0.3),
                0 0 40px hsl(var(--primary) / 0.2),
                inset 0 0 20px hsl(var(--primary) / 0.1);
    animation: scanner-glow 2.5s ease-in-out infinite;
  }

  .scanner-ticket-btn:hover {
    background: linear-gradient(135deg, hsl(var(--primary) / 0.25), hsl(var(--primary) / 0.15));
    border-color: hsl(var(--primary) / 0.8) !important;
    box-shadow: 0 0 30px hsl(var(--primary) / 0.5),
                0 0 60px hsl(var(--primary) / 0.3),
                inset 0 0 30px hsl(var(--primary) / 0.2);
    transform: scale(1.05);
    animation: none;
  }

  @keyframes scanner-glow {
    0%, 100% {
      box-shadow: 0 0 20px hsl(var(--primary) / 0.3),
                  0 0 40px hsl(var(--primary) / 0.2),
                  inset 0 0 20px hsl(var(--primary) / 0.1);
      border-color: hsl(var(--primary) / 0.5);
    }
    50% {
      box-shadow: 0 0 30px hsl(var(--primary) / 0.5),
                  0 0 60px hsl(var(--primary) / 0.4),
                  inset 0 0 30px hsl(var(--primary) / 0.2);
      border-color: hsl(var(--primary) / 0.7);
    }
  }

  .scanner-ticket-btn::before {
    content: '';
    position: absolute;
    top: -3px;
    left: -3px;
    right: -3px;
    bottom: -3px;
    background: linear-gradient(45deg, 
      hsl(var(--primary) / 0.6),
      hsl(var(--secondary) / 0.6),
      hsl(var(--primary) / 0.6)
    );
    border-radius: inherit;
    z-index: -1;
    opacity: 0.3;
    animation: scanner-border-pulse 2.5s ease-in-out infinite;
  }

  @keyframes scanner-border-pulse {
    0%, 100% {
      opacity: 0.2;
      transform: scale(1);
    }
    50% {
      opacity: 0.5;
      transform: scale(1.02);
    }
  }

  .scanner-ticket-btn:hover::before {
    opacity: 0.6;
    animation: none;
  }
}